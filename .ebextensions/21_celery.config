packages:
  yum:
    libcurl-devel: []
    openssl-devel: []

container_commands:
  01_mkdir_for_log_and_pid:
    command: 'mkdir -p /var/log/celery/ /var/run/celery/'
  02_create_celery_beat_configuration_file:
    command: "cat .ebextensions/files/celery_configuration.txt > /opt/elasticbeanstalk/hooks/appdeploy/post/run_supervised_celeryd.sh && chmod 744 /opt/elasticbeanstalk/hooks/appdeploy/post/run_supervised_celeryd.sh && sed -i 's/\r$//' /opt/elasticbeanstalk/hooks/appdeploy/post/run_supervised_celeryd.sh"
  # restart celery beat if leader
  02_run_script:
    command: "/opt/elasticbeanstalk/hooks/appdeploy/post/run_supervised_celeryd.sh"